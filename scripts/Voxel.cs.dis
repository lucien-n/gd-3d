using Godot;

public partial class Voxel : Node3D
{
    private MeshInstance3D mesh;
    private CollisionShape3D collision_shape;
    private Area3D area;

    private Material _base;
    private Material _highlighted;

    public Voxel(Vector3 position)
    {
        mesh = new MeshInstance3D
        {
            Position = position,
            MaterialOverride = new Material() as BaseMaterial3D,
            Mesh = new BoxMesh()
        };

        collision_shape = new CollisionShape3D
        {
            Shape = new BoxShape3D()
        };

        area = new Area3D();
    }

    public override void _Ready()
    {
        _base = GD.Load<Material>("res://materials/base.tres");
        _highlighted = GD.Load<Material>("res://materials/highlighted.tres");

        AddChild(mesh);
        area.AddChild(collision_shape);
        AddChild(area);
    }

    public void OnAreaMouseEntered()
    {
        mesh.MaterialOverride = _highlighted;
    }

    public void OnAreaMouseExited()
    {
        mesh.MaterialOverride = _base;
    }
}